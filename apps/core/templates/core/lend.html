{% extends "base.html" %}
{% block title %}Lending Book{% endblock title %}
{% block content %}
    <div>
        <h2>Lend Book/Return Book</h2>
        {% if message %}
            <p>{{ message }}</p>
        {% endif %}
        <form method="post">
            {% csrf_token %}
            <select name="reader">
                <option value="">-- Select Reader --</option>
                {% for r in readers %}
                <option value="{{ r.id }}">{{ r.first_name }} {{ r.surname }}</option>
                {% endfor %}
            </select>
            <select name="book">
                <option value="">-- Select Book --</option>
                {% for b in books %}
                <option value="{{ b.id }}">{{ b.title }}</option>
                {% endfor %}
            </select>
            <button type="submit" name="lending_submit">Lend</button>
        </form>
    </div>
    <div>
        <h2>Current Lending Books</h2>
        <table>
            <tr>
                <th>Reader</th>
                <th>Book</th>
                <th>Lend Date</th>
                <th>Returned</th>
            </tr>
            {% for l in lendings %}
            <tr>
                <td>{{ l.reader.first_name }} {{ l.reader.surname }}</td>
                <td>{{ l.book.title }}</td>
                <td>{{ l.lending_date }}</td>
                <td>{{ l.returned }}</td>
                <td>
                    <form method="post">
                        {% csrf_token %}
                        <input type="hidden" name="return_lending_id" value="{{ l.id }}">
                        <button type="submit">Return</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
{% endblock content %}

